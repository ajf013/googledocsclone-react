{"version":3,"sources":["TextEditor.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","useEffect","s","io","disconnect","once","document","setContents","enable","emit","interval","setInterval","getContents","clearInterval","handler","delta","updateContents","on","off","oldDelta","source","wrapperRef","useCallback","wrapper","innnerHTML","editor","createElement","append","q","Quill","theme","modules","toolbar","disable","setText","className","ref","App","path","exact","to","uuidV4","ReactDOM","render","StrictMode","getElementById"],"mappings":"yNAOMA,EAAkB,CACpB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,OAAS,CAAEA,OAAQ,UAC9B,CAAC,CAAEC,MAAO,KACV,CAAC,QAAS,aAAc,cACxB,CAAC,UAGU,SAASC,IAAc,IACvBC,EAAcC,cAAlBC,GAD0B,EAELC,qBAFK,mBAE1BC,EAF0B,KAElBC,EAFkB,OAGPF,qBAHO,mBAG1BG,EAH0B,KAGnBC,EAHmB,KAKjCC,qBAAU,WACN,IAAMC,EAAGC,aAAG,yBAGZ,OAFAL,EAAUI,GAEH,WACHA,EAAEE,gBAEP,IAEHH,qBAAU,WACQ,MAAVJ,GAA2B,MAATE,IAEtBF,EAAOQ,KAAK,iBAAiB,SAAAC,GACzBP,EAAMQ,YAAYD,GAClBP,EAAMS,YAGVX,EAAOY,KAAK,eAAgBhB,MAC7B,CAACI,EAAQE,EAAON,IAEnBQ,qBAAU,WACN,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMW,EAAWC,aAAY,WACzBd,EAAOY,KAAK,gBAAiBV,EAAMa,iBA1CtB,KA6CjB,OAAO,WACHC,cAAcH,OAEnB,CAACb,EAAQE,IAEZE,qBAAU,WACN,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMe,EAAU,SAACC,GACbhB,EAAMiB,eAAeD,IAIzB,OAFAlB,EAAOoB,GAAG,kBAAmBH,GAEtB,WACHjB,EAAOqB,IAAI,kBAAmBJ,OAEnC,CAACjB,EAAQE,IAEZE,qBAAU,WACN,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMe,EAAU,SAACC,EAAOI,EAAUC,GAChB,SAAXA,GACHvB,EAAOY,KAAK,eAAgBM,IAIhC,OAFAhB,EAAMkB,GAAG,cAAeH,GAEjB,WACHf,EAAMmB,IAAI,cAAeJ,OAE9B,CAACjB,EAAQE,IAEZ,IAAMsB,EAAaC,uBAAY,SAAAC,GAC3B,GAAe,MAAXA,EAAJ,CAEAA,EAAQC,WAAa,GACrB,IAAMC,EAASnB,SAASoB,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CAAEK,MAAO,OAAQC,QAAS,CAAEC,QAAShD,KAEjE4C,EAAEK,UACFL,EAAEM,QAAQ,cACVlC,EAAS4B,MACV,IACH,OAAO,qBAAKO,UAAU,YAAYC,IAAKf,I,oBCtE5BgB,MAff,WACE,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAM,IAAIC,OAAK,EAAtB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,oBAE9B,cAAC,IAAD,CAAOH,KAAM,iBAAb,SACF,cAAC9C,EAAD,Y,MCbNkD,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFtC,SAASuC,eAAe,W","file":"static/js/main.b031dcc5.chunk.js","sourcesContent":["import { useCallback, useEffect, useState } from 'react'\r\nimport Quill from \"quill\"\r\nimport \"quill/dist/quill.snow.css\"\r\nimport { io } from \"socket.io-client\"\r\nimport { useParams } from \"react-router-dom\"\r\n\r\nconst SAVE_INTERVAL_MS = 2000\r\nconst TOOLBAR_OPTIONS = [\r\n    [{ header: [1, 2, 3, 4, 5, 6, false] }],\r\n    [{ font: [] }],\r\n    [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n    [\"bold\", \"italic\", \"underline\"],\r\n    [{ color: [] }, { background: [] }],\r\n    [{ script: \"sub\" }, { script: \"super\" }],\r\n    [{ align: [] }],\r\n    [\"image\", \"blockquote\", \"code-block\"],\r\n    [\"clean\"],\r\n]\r\n\r\nexport default function TextEditor() {\r\n    const {id: documentId} = useParams()\r\n    const [socket, setSocket] = useState()\r\n    const [quill, setQuill] = useState()\r\n\r\n    useEffect(() => {\r\n        const s= io(\"http://localhost:3001\")\r\n        setSocket(s)\r\n\r\n        return () => {\r\n            s.disconnect()\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return\r\n\r\n        socket.once(\"load-document\", document => {\r\n            quill.setContents(document)\r\n            quill.enable()    \r\n        })\r\n\r\n        socket.emit('get-document', documentId)\r\n    }, [socket, quill, documentId])\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return\r\n\r\n        const interval = setInterval(() =>{\r\n            socket.emit('save-document', quill.getContents())\r\n        }, SAVE_INTERVAL_MS)\r\n\r\n        return () => {\r\n            clearInterval(interval)\r\n        }\r\n    }, [socket, quill])\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return\r\n        \r\n        const handler = (delta) => {\r\n            quill.updateContents(delta)\r\n        }\r\n        socket.on('receive-changes', handler)\r\n\r\n        return () => {\r\n            socket.off('receive-changes', handler)\r\n        }\r\n    }, [socket, quill])\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return\r\n\r\n        const handler = (delta, oldDelta, source) => {\r\n            if(source !== 'user') return\r\n            socket.emit(\"send-changes\", delta)\r\n        }\r\n        quill.on('text-change', handler)\r\n\r\n        return () => {\r\n            quill.off('text-change', handler)\r\n        }\r\n    }, [socket, quill])\r\n    \r\n    const wrapperRef = useCallback(wrapper => {\r\n        if (wrapper == null) return\r\n\r\n        wrapper.innnerHTML = \"\"\r\n        const editor = document.createElement(\"div\")\r\n        wrapper.append(editor)\r\n        const q = new Quill(editor, { theme: \"snow\", modules: { toolbar: TOOLBAR_OPTIONS } \r\n    })\r\n        q.disable()\r\n        q.setText('Loading...')\r\n        setQuill(q)\r\n    }, [])\r\n    return <div className=\"container\" ref={wrapperRef}></div>\r\n}\r\n","import React from 'react'\nimport TextEditor from './TextEditor';\nimport { \n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Redirect\n} from 'react-router-dom'\nimport { v4 as uuidV4 } from 'uuid'\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path =\"/\" exact> \n          <Redirect to={`/documents/${uuidV4()}`} />   \n        </Route>\n        <Route path =\"/documents/:id\">\n      <TextEditor />\n      </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport \"./styles.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}